<app-spinner-loader></app-spinner-loader>
<app-alert></app-alert>

<div
  class="master-container"
  fxLayout="column"
  fxLayoutAlign="center stretch">

  <!-- header -->
  <div
    class="header"
    fxFlex>

    <mat-toolbar
      id="mainToolbar"
      class="mat-elevation-z5"
      color="primary">
      <button
        mat-icon-button
        (click)="appService.onToggleLeftSidebar()"
        [disabled]="!isTracingActive()">
        <mat-icon>menu</mat-icon>
      </button>
      <button
        mat-button
        [routerLink]="authService.loggedIn() ? ['/main'] : ['/']"
        id="homeButton">
        <span class="mat-title">{{ appName }}</span>
      </button>
      <span
        class="toolbarSpan"
        fxFlex></span>

      <button
        *ngIf="authService.loggedIn() && !isTracingActive()"
        mat-icon-button
        [routerLink]="['/tracing']"
        matTooltip="Tracing view">
        <mat-icon>timeline</mat-icon>

      </button>

      <button
        *ngIf="authService.loggedIn() && isTracingActive()"
        mat-icon-button
        (click)="appService.onSaveImage()">
        <mat-icon>image</mat-icon>
      </button>
      <input
        *ngIf="authService.loggedIn() && isTracingActive()"
        id="fileInput"
        #fileInput
        type="file"
        (change)="appService.onLoad($event)">
      <button
        *ngIf="authService.loggedIn() && isTracingActive()"
        mat-icon-button
        onclick="document.getElementById('fileInput').click()">
        <mat-icon>file_upload</mat-icon>
      </button>
      <button
        *ngIf="authService.loggedIn() && isTracingActive()"
        mat-icon-button
        (click)="appService.onSave()">
        <mat-icon>file_download</mat-icon>
      </button>
      <button
        *ngIf="!rightSidenav.opened && authService.loggedIn() && isTracingActive()"
        mat-icon-button
        (click)="appService.onToggleRightSidebar()">
        <mat-icon>info</mat-icon>
      </button>
      <button
        *ngIf="rightSidenav.opened && authService.loggedIn() && isTracingActive()"
        mat-mini-fab
        (click)="appService.onToggleRightSidebar()">
        <mat-icon>info</mat-icon>
      </button>
      <mat-divider [inset]="true" [vertical]="true"></mat-divider>

      <a
        *ngIf="!authService.loggedIn()"
        mat-button
        [routerLink]="['/users/login']">
        <mat-icon>exit_to_app</mat-icon>
        Login/Register
      </a>

      <button
        *ngIf="authService.loggedIn()"
        mat-icon-button
        [matMenuTriggerFor]="menu">
        <mat-icon>account_circle</mat-icon>
      </button>
      <mat-menu
        #menu="matMenu"
        [overlapTrigger]="false">
        <div mat-menu-item disabled>
          <mat-icon>account_circle</mat-icon>
          <span>{{ getCurrentUserEmail() }}</span>
        </div>
        <mat-divider></mat-divider>
        <button
          mat-menu-item
          (click)="logout()">
          <mat-icon>power_settings_new</mat-icon>
          <span>Logout</span>
        </button>
        <!-- <button mat-menu-item disableRipple>
          <mat-icon>voicemail</mat-icon>
          <span>Check voicemail</span>
        </button>
        <button mat-menu-item>
          <mat-icon>notifications_off</mat-icon>
          <span>Disable alerts</span>
        </button> -->
      </mat-menu>


    </mat-toolbar>
  </div>


  <!-- main content -->
  <div
    class="main-content"
    fxFlex="90vh">

    <mat-sidenav-container
      id="sidenavContainer"
      #sidenavContainer>

      <!-- left sidenav -->
      <mat-sidenav
        id="leftSidenav"
        #leftSidenav
        position="start"
        mode="side">
        <h1>mat-sidenav</h1>
      </mat-sidenav>

      <!-- main content -->
      <mat-sidenav-content>
        <router-outlet></router-outlet>
      </mat-sidenav-content>

      <!-- right sidenav -->
      <mat-sidenav
        id="rightSidenav"
        #rightSidenav
        position="end"
        mode="side">
        <div id="rightSidenavContent">
          <div id="sidenavSlider" #sidenavSlider>
            <div id="sidenavSliderCenter"></div>
          </div>
          <app-table #table></app-table>
        </div>
      </mat-sidenav>

    </mat-sidenav-container>
  </div>


  <!-- footer -->
  <div
    class="footer"
    fxFlex>
    <mat-toolbar
      class="mat-elevation-z5"
      color="accent"
      fxLayout="row"
      fxLayoutAlign="center center">
      <div class="footer-element" fxFlex>
        <a
          mat-button
          href="https://www.bfr.bund.de"
          target="_blank">
          <mat-icon>public</mat-icon>
          <span class="mat-caption"> BfR - Bundesinstitut für Risikobewertung</span>
          <!-- BfR - Bundesinstitut für Risikobewertung -->
        </a>
      </div>
      <div class="footer-element" fxFlex>
        <a
          mat-button
          href="https://foodrisklabs.bfr.bund.de"
          target="_blank">
          <mat-icon>public</mat-icon>
          <span class="mat-caption"> FoodRisk - Labs</span>
        </a>
      </div>
      <div class="footer-element" fxFlex>
        <a
          mat-button
          href="mailto:{{ supportContact }}"
          target="_top">
          <mat-icon>mail</mat-icon>
          <span class="mat-caption"> Report a Problem</span>
        </a>
      </div>
    </mat-toolbar>
  </div>

</div>



<!-- <mat-toolbar
  id="mainToolbar"
  class="mat-elevation-z5"
  color="primary">
  <button
    mat-icon-button
    (click)="leftSidenav.toggle()">
    <mat-icon>menu</mat-icon>
  </button>
  <button
    mat-button
    (click)="onHome()"
    id="homeButton">
    {{ appName }}
  </button>
  <span class="toolbarSpan"></span>
  <button
    mat-icon-button
    (click)="onSaveImage()">
    <mat-icon>image</mat-icon>
  </button>
  <input
    id="fileInput"
    #fileInput
    type="file"
    (change)="onLoad($event)">
  <button
    mat-icon-button
    onclick="document.getElementById('fileInput').click()">
    <mat-icon>file_upload</mat-icon>
  </button>
  <button
    mat-icon-button
    (click)="onSave()">
    <mat-icon>file_download</mat-icon>
  </button>
  <button
    *ngIf="!rightSidenav.opened"
    mat-icon-button
    (click)="rightSidenav.toggle()">
    <mat-icon>info</mat-icon>
  </button>
  <button
    *ngIf="rightSidenav.opened"
    mat-mini-fab
    (click)="rightSidenav.toggle()">
    <mat-icon>info</mat-icon>
  </button>
  <mat-divider [inset]="true" [vertical]="true"></mat-divider>

  <a
    mat-button
    [routerLink]="['/users/login']">
    <mat-icon>exit_to_app</mat-icon>
    Login
  </a>
</mat-toolbar>

<mat-sidenav-container id="mainContainer" #mainContainer>
    <mat-sidenav
      id="leftSidenav"
      #leftSidenav
      position="start"
      mode="side">

      <mat-toolbar color="primary">
        <span>Graph Settings</span>
      </mat-toolbar>

      <div class="sidenav-elements">
        <mat-radio-group
          [(ngModel)]="data.graphSettings.type"
          (ngModelChange)="onGraphChange('type')">
          <mat-radio-button *ngFor="let type of graphTypes" [value]="type">
            {{type}}
          </mat-radio-button>
        </mat-radio-group>
        <mat-form-field>
            <mat-select
              placeholder="Node Size"
              [(ngModel)]="data.graphSettings.nodeSize"
              (ngModelChange)="onGraphChange('nodeSize')">
              <mat-option *ngFor="let size of sizes" [value]="size">
                {{size}}
              </mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field>
            <mat-select
              placeholder="Font Size"
              [(ngModel)]="data.graphSettings.fontSize"
              (ngModelChange)="onGraphChange('fontSize')">
              <mat-option *ngFor="let size of sizes" [value]="size">
                {{size}}
              </mat-option>
            </mat-select>
        </mat-form-field>
        <mat-checkbox
          [(ngModel)]="data.graphSettings.mergeDeliveries"
          (ngModelChange)="onGraphChange('mergeDeliveries')">
          Merge Deliveries
        </mat-checkbox>
        <mat-checkbox
          [(ngModel)]="data.graphSettings.showLegend"
          (ngModelChange)="onGraphChange('showLegend')">
          Show Legend
        </mat-checkbox>
        <mat-checkbox
          [(ngModel)]="data.graphSettings.showZoom"
          (ngModelChange)="onGraphChange('showZoom')">
          Show Zoom Controls
        </mat-checkbox>
      </div>

      <mat-toolbar color="primary">
        <span>Table Settings</span>
      </mat-toolbar>

      <div class="sidenav-elements">
        <mat-radio-group
          [(ngModel)]="data.tableSettings.mode"
          (ngModelChange)="onTableChange('mode')">
          <mat-radio-button *ngFor="let mode of tableModes" [value]="mode">
            {{mode}}
          </mat-radio-button>
        </mat-radio-group>
        <button
          mat-raised-button
          (click)="changeColumns()">
          Change Columns
        </button>
        <mat-form-field>
          <mat-select
            placeholder="Show Type"
            [(ngModel)]="data.tableSettings.showType"
            (ngModelChange)="onTableChange('showType')">
            <mat-option *ngFor="let showType of showTypes" [value]="showType">
              {{showType}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-sidenav>

    <div id="mainContent">
      <router-outlet></router-outlet>
      <app-graph #graph [hidden]="data.graphSettings.type != graphType"></app-graph>
      <app-gis #gis [hidden]="data.graphSettings.type != gisType"></app-gis>
    </div>

    <mat-sidenav id="rightSidenav" #rightSidenav position="end" mode="side">
      <div id="rightSidenavContent">
        <div id="sidenavSlider" #sidenavSlider>
          <div id="sidenavSliderCenter"></div>
        </div>
        <app-table #table></app-table>
      </div>
    </mat-sidenav>
  </mat-sidenav-container> -->
